<Window x:Name="Main" x:Class="E.Writer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:E.Writer"
        mc:Ignorable="d"
        Title="E Writer" Height="800" Width="1000" AllowDrop="True" MinWidth="600" MinHeight="550" WindowStartupLocation="CenterScreen" KeyUp="Main_KeyUp" Loaded="Main_Loaded" Closing="Main_Closing" Foreground="Black" Icon="图片/E Writer.ico" Background="Black">

    <!--自定义控件模板-->
    <Window.Resources>
        <ControlTemplate x:Key="FrameTemplate" TargetType="{x:Type Frame}">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                    <Button Content="后退" Margin="4" Command="{x:Static NavigationCommands.BrowseBack}" />
                    <Button Content="前进" Margin="4" Command="{x:Static NavigationCommands.BrowseForward}" />
                    <Button Content="刷新" Margin="4" Command="{x:Static NavigationCommands.Refresh}" />
                </StackPanel>
                <Border BorderBrush="Orange"  BorderThickness="2"  Padding="5">
                    <ContentPresenter />
                </Border>
            </DockPanel>
        </ControlTemplate>

        <Style x:Key="MyMenuButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="Gainsboro"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" SnapsToDevicePixels="True">
                            <TextBlock Text="{TemplateBinding Content}" Foreground="{TemplateBinding Foreground}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF00C5FF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF006496"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="MyToolButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="#FFF0F0F0"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" SnapsToDevicePixels="True">
                            <TextBlock Text="{TemplateBinding Content}" Foreground="{TemplateBinding Foreground}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF00C5FF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF006496"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="MyLabelStyle" TargetType="Label">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
        
        <Style x:Key="MyCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Padding" Value="5,0,0,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        
        <Style x:Key="MyComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Padding" Value="5,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        
        <Style x:Key="MyTextBoxStyle" TargetType="TextBox">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Padding" Value="5,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Background" Value="{x:Null}"/>
        </Style>
    </Window.Resources>
    
    <Grid x:Name="MainGrid">
        <DockPanel>
            <DockPanel x:Name="PanLeft" Background="#FFF0F0F0" >
                <StackPanel DockPanel.Dock="Top">
                    <Button x:Name="BtnFile" Content="{DynamicResource 文件}" Style="{StaticResource MyMenuButtonStyle}" Click="BtnFile_Click"/>
                    <Button x:Name="BtnEdit" Content="{DynamicResource 编辑}" Style="{StaticResource MyMenuButtonStyle}" Click="BtnEdit_Click"/>
                    <Button x:Name="BtnView" Content="{DynamicResource 视图}" Style="{StaticResource MyMenuButtonStyle}" Click="BtnView_Click"/>
                    <Button x:Name="BtnSetting" Content="{DynamicResource 设置}" Style="{StaticResource MyMenuButtonStyle}" Click="BtnSetting_Click"/>
                    <Button x:Name="BtnAbout" Content="{DynamicResource 关于}" Style="{StaticResource MyMenuButtonStyle}" Click="BtnAbout_Click"/>
                </StackPanel>
                <WrapPanel Orientation="Vertical">
                    <WrapPanel  x:Name="BtnsFile" Orientation="Vertical">
                        <Button x:Name="BtnOpenBook" Content="开书" ToolTip="{DynamicResource 打开书籍}" Style="{StaticResource MyToolButtonStyle}" Click="BtnOpen_Click"/>
                        
                        <Button x:Name="BtnCloseBook" Content="关书" ToolTip="{DynamicResource 关闭书籍}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCloseBook_Click" />
                        <Button x:Name="BtnCloseChapter" Content="关卷" ToolTip="{DynamicResource 关闭卷册}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCloseChapter_Click" />
                        <Button x:Name="BtnCloseEssay" Content="关文" ToolTip="{DynamicResource 关闭文章}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCloseEssay_Click" />
                        
                        <Button x:Name="BtnCreateBook" Content="创书" ToolTip="{DynamicResource 创建书籍}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCreateBook_Click"/>
                        <Button x:Name="BtnCreateChapter" Content="创卷" ToolTip="{DynamicResource 创建卷册}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCreateChapter_Click"/>
                        <Button x:Name="BtnCreateEssay" Content="创文" ToolTip="{DynamicResource 创建文章}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCreateEssay_Click"/>
                        
                        <Button x:Name="BtnSave" Content="保存" ToolTip="{DynamicResource 保存文章}" Style="{StaticResource MyToolButtonStyle}" Click="BtnSave_Click" />
                        <Button x:Name="BtnSaveAs" Content="另存" ToolTip="{DynamicResource 另存文章}" Style="{StaticResource MyToolButtonStyle}" Click="BtnSaveAs_Click" />
                        <Button x:Name="BtnExport" Content="导出" ToolTip="{DynamicResource 导出全文}" Style="{StaticResource MyToolButtonStyle}" Click="BtnExport_Click" />
                        
                        <Button x:Name="BtnDelete" Content="删除" ToolTip="{DynamicResource 删除目标}" Style="{StaticResource MyToolButtonStyle}" Click="BtnDelete_Click" />
                        
                        <Button x:Name="BtnBookInfo" Content="书信" ToolTip="{DynamicResource 书籍信息}" Style="{StaticResource MyToolButtonStyle}" Click="BtnBookInfo_Click" />
                        <Button x:Name="BtnChapterInfo" Content="卷信" ToolTip="{DynamicResource 卷册信息}" Style="{StaticResource MyToolButtonStyle}" Click="BtnChapterInfo_Click" />
                    </WrapPanel>
                    <WrapPanel  x:Name="BtnsEdit" Orientation="Vertical" Visibility="Collapsed">
                        <Button x:Name="BtnUndo" Content="撤销" ToolTip="{DynamicResource 撤销}" Style="{StaticResource MyToolButtonStyle}" Click="BtnUndo_Click" />
                        <Button x:Name="BtnRedo" Content="重做" ToolTip="{DynamicResource 重做}" Style="{StaticResource MyToolButtonStyle}" Click="BtnRedo_Click" />
                        <Button x:Name="BtnCopy" Content="复制" ToolTip="{DynamicResource 复制}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCopy_Click" />
                        <Button x:Name="BtnCut" Content="剪切" ToolTip="{DynamicResource 剪切}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCut_Click" />
                        <Button x:Name="BtnPaste" Content="粘贴" ToolTip="{DynamicResource 粘贴}" Style="{StaticResource MyToolButtonStyle}" Click="BtnPaste_Click" />
                        <Button x:Name="BtnToTraditional" Content="转繁" ToolTip="{DynamicResource 转繁}" Style="{StaticResource MyToolButtonStyle}" Click="BtnToTraditional_Click" />
                        <Button x:Name="BtnToSimplified" Content="转简" ToolTip="{DynamicResource 转简}" Style="{StaticResource MyToolButtonStyle}" Click="BtnToSimplified_Click" />
                        <Button x:Name="BtnFindAndReplace" Content="查换" ToolTip="{DynamicResource 查换}" Style="{StaticResource MyToolButtonStyle}" Click="BtnFindAndReplace_Click" />
                    </WrapPanel>
                    <WrapPanel  x:Name="BtnsView" Orientation="Vertical" Visibility="Collapsed">
                        <Button x:Name="BtnFold" Content="折叠" ToolTip="{DynamicResource 折叠}" Style="{StaticResource MyToolButtonStyle}" Click="BtnFold_Click" />
                        <Button x:Name="BtnExpand" Content="展开" ToolTip="{DynamicResource 展开}" Style="{StaticResource MyToolButtonStyle}" Click="BtnExpand_Click" />
                        <Button x:Name="BtnCollapse" Content="收起" ToolTip="{DynamicResource 收起}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCollapse_Click" />
                        <Button x:Name="BtnRefresh" Content="刷新" ToolTip="{DynamicResource 刷新}" Style="{StaticResource MyToolButtonStyle}" Click="BtnRefresh_Click" />
                    </WrapPanel>
                    <WrapPanel  x:Name="BtnsSetting" Orientation="Vertical" Visibility="Collapsed">
                        <Button x:Name="BtnReset" Content="重置" ToolTip="{DynamicResource 重置}" Style="{StaticResource MyToolButtonStyle}" Click="BtnReset_Click"/>
                        <Button x:Name="BtnApply" Content="应用" ToolTip="{DynamicResource 应用}" Style="{StaticResource MyToolButtonStyle}" Click="BtnApply_Click"/>
                        <Button x:Name="BtnClearRunInfo" Content="清空" ToolTip="{DynamicResource 清空运行信息}" Style="{StaticResource MyToolButtonStyle}" Click="BtnClearRunInfo_Click"/>
                    </WrapPanel>
                    <WrapPanel  x:Name="BtnsAbout" Orientation="Vertical" Visibility="Collapsed">
                        <Button x:Name="BtnHomePage" Content="官网" ToolTip="{DynamicResource 官方网站}" Style="{StaticResource MyToolButtonStyle}" Click="BtnHomePage_Click"/>
                        <Button x:Name="BtnInfoPage" Content="主页" ToolTip="{DynamicResource 应用主页}" Style="{StaticResource MyToolButtonStyle}" Click="BtnInfoPage_Click" />
                        <Button x:Name="BtnCheckNew" Content="更新" ToolTip="{DynamicResource 检查更新}" Style="{StaticResource MyToolButtonStyle}" Click="BtnCheckNew_Click"/>
                        <Button x:Name="BtnDownloadPage" Content="反馈" ToolTip="{DynamicResource 提交反馈}" Style="{StaticResource MyToolButtonStyle}" Click="BtnDownloadPage_Click"/>
                        <Button x:Name="BtnGitHubPage" Content="GitHub" ToolTip="{DynamicResource GitHub}" Style="{StaticResource MyToolButtonStyle}" Click="BtnGitHubPage_Click"/>
                        <Button x:Name="BtnQQGroup" Content="QQ群" ToolTip="{DynamicResource QQ交流群}" Style="{StaticResource MyToolButtonStyle}" Click="BtnQQGroup_Click"/>
                        <Button x:Name="BtnBitCoinAddress" Content="赞助" ToolTip="{DynamicResource 赞助}" Style="{StaticResource MyToolButtonStyle}" Click="BtnBitCoinAddress_Click"/>
                    </WrapPanel>
                </WrapPanel>
            </DockPanel>
            <Grid x:Name="PanCenter" Background="#FFF0F0F0" Width="210">
                <DockPanel x:Name="CenterDirectoryPage">
                    <ComboBox x:Name="Books" BorderBrush="{x:Null}" VerticalAlignment="Top" Height="30" ToolTip="最近打开过的书籍列表" SelectionChanged="Books_SelectionChanged" Background="White" Padding="0" FontSize="14" VerticalContentAlignment="Center" BorderThickness="0" Cursor="Hand" SizeChanged="Books_SizeChanged" DockPanel.Dock="Top" />
                    <TreeView x:Name="FilesTree" Margin="0" SelectedItemChanged="FilesTree_SelectedItemChanged" MouseDoubleClick="FilesTree_MouseDoubleClick" KeyUp="FilesTree_KeyUp" BorderBrush="{x:Null}" Padding="0,5" Background="#00000000"/>
                </DockPanel>

                <DockPanel  x:Name="CenterSettingPage" Visibility="Collapsed">
                    <ScrollViewer>
                        <StackPanel DockPanel.Dock="Top">
                            <Label Content="{DynamicResource 语言}" Style="{StaticResource MyLabelStyle}"/>
                            <ComboBox x:Name="CBSelectedLanguage" Style="{StaticResource MyComboBoxStyle}" SelectionChanged="CBSelectedLanguage_SelectionChanged"/>

                            <Label Content="{DynamicResource 主题}" Style="{StaticResource MyLabelStyle}"/>
                            <ComboBox x:Name="Skins" Style="{StaticResource MyComboBoxStyle}" SelectionChanged="Skins_SelectionChanged"/>

                            <Label Content="{DynamicResource 字体}" Style="{StaticResource MyLabelStyle}"/>
                            <ComboBox x:Name="CBFonts" Style="{StaticResource MyComboBoxStyle}" SelectionChanged="CBFonts_SelectionChanged"/>

                            <Label Content="{DynamicResource 字号}" Style="{StaticResource MyLabelStyle}"/>
                            <TextBox x:Name="TextSize" Style="{StaticResource MyTextBoxStyle}" KeyUp="TextSize_KeyUp"/>

                            <Label Content="{DynamicResource 界面}"  Style="{StaticResource MyLabelStyle}"/>
                            <CheckBox x:Name="ShowScrollBar" Content="{DynamicResource 显示滚动条}" Style="{StaticResource MyCheckBoxStyle}" Checked="ShowScrollBar_Checked" Unchecked="ShowScrollBar_Unchecked"/>

                            <Label Content="{DynamicResource 启动}"  Style="{StaticResource MyLabelStyle}"/>
                            <CheckBox x:Name="ShowRunInfoCheckBox" Content="{DynamicResource 显示运行信息}" Style="{StaticResource MyCheckBoxStyle}" Checked="ShowRunInfo_Checked" Unchecked="ShowRunInfo_Unchecked"/>
                            <CheckBox x:Name="AutoOpenBookCheckBox" Content="{DynamicResource 自动打开书籍}" Style="{StaticResource MyCheckBoxStyle}" Checked="AutoOpenBook_Checked" Unchecked="AutoOpenBook_Unchecked"/>

                            <Label Content="{DynamicResource 补全}" Style="{StaticResource MyLabelStyle}"/>
                            <CheckBox x:Name="AutoBrackets" Content="{DynamicResource 补全书名号}" Style="{StaticResource MyCheckBoxStyle}" Checked="AutoBrackets_Checked" Unchecked="AutoBrackets_Unchecked"/>
                            <CheckBox x:Name="AutoCompletion" Content="{DynamicResource 自动补全}" Style="{StaticResource MyCheckBoxStyle}" Checked="AutoCompletion_Checked" Unchecked="AutoCompletion_Unchecked"/>

                            <Label Content="{DynamicResource 缩进}" Style="{StaticResource MyLabelStyle}"/>
                            <CheckBox x:Name="AutoIndentation" Content="{DynamicResource 自动缩进}" Style="{StaticResource MyCheckBoxStyle}" Checked="AutoIndentation_Checked" Unchecked="AutoIndentation_Unchecked"/>
                            <TextBox x:Name="AutoIndentations" Style="{StaticResource MyTextBoxStyle}" Text="4" ToolTip="按回车键保存更改" KeyUp="AutoIndentations_KeyUp"/>

                            <Label Content="{DynamicResource 保存}" Style="{StaticResource MyLabelStyle}"/>
                            <CheckBox x:Name="AutoSaveWhenSwitch" Content="{DynamicResource 文章切换时自动保存}" Style="{StaticResource MyCheckBoxStyle}" Checked="AutoSaveWhenSwitch_Checked" Unchecked="AutoSaveWhenSwitch_Unchecked"/>
                            <CheckBox x:Name="AutoSaveEvery" Content="{DynamicResource 间隔时间自动保存}" Style="{StaticResource MyCheckBoxStyle}" Checked="AutoSaveEvery_Checked" Unchecked="AutoSaveEvery_Unchecked"/>
                            <TextBox x:Name="AutoSaveTime" Style="{StaticResource MyTextBoxStyle}" KeyUp="AutoSaveTime_KeyUp" ToolTip="按回车键保存更改"/>

                            <Label Content="{DynamicResource 备份}" Style="{StaticResource MyLabelStyle}"/>
                            <CheckBox x:Name="AutoBackup" Content="{DynamicResource 间隔时间自动备份}" Style="{StaticResource MyCheckBoxStyle}" Unchecked="AutoBackup_Unchecked"/>
                            <TextBox x:Name="AutoBackupTime" Style="{StaticResource MyTextBoxStyle}" Text="10" KeyUp="AutoBackupTime_KeyUp" ToolTip="按回车键保存更改" Margin="5,0,5,5"/>
                        </StackPanel>
                    </ScrollViewer>
                </DockPanel>

                <DockPanel x:Name="CenterAboutPage" Visibility="Collapsed">
                    <StackPanel DockPanel.Dock="Top">
                        <Label Content="{DynamicResource 名称}" Style="{StaticResource MyLabelStyle}"/>
                        <Label x:Name="ThisName" Content="?" HorizontalAlignment="Left" Margin="0" VerticalAlignment="Top"/>
                        <Label Content="{DynamicResource 说明}" Style="{StaticResource MyLabelStyle}"/>
                        <Label x:Name="Description" Content="?" HorizontalAlignment="Left" Margin="0" VerticalAlignment="Top"/>
                        <Label Content="{DynamicResource 作者}" Style="{StaticResource MyLabelStyle}"/>
                        <Label x:Name="Developer" Content="?" HorizontalAlignment="Left" Margin="0" VerticalAlignment="Top"/>
                        <Label Content="{DynamicResource 版本}"  Style="{StaticResource MyLabelStyle}"/>
                        <Label x:Name="Version" Content="?" Margin="0" VerticalAlignment="Top" HorizontalAlignment="Left"/>
                        <Label Content="{DynamicResource 更新日志}" Style="{StaticResource MyLabelStyle}"/>
                    </StackPanel>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <TextBlock x:Name="UpdateNote" Text="?" TextWrapping="Wrap" Padding="5" />
                    </ScrollViewer>
                </DockPanel>
            </Grid>

            <DockPanel x:Name="PanRight" Background="#FFF0F0F0" Margin="0">
                <TextBox x:Name="EssayName" Height="30" VerticalAlignment="Top" ToolTip="当前未选中任何文件" VerticalContentAlignment="Center" GotFocus="EssayName_GotFocus" KeyUp="EssayName_KeyUp" CaretBrush="Black" DockPanel.Dock="Top" Text="标题" FontWeight="Bold" FontSize="16" Padding="5,0" BorderBrush="{x:Null}" Background="{x:Null}"/>
                <DockPanel DockPanel.Dock="Bottom"> 
                    <Label x:Name="Words" Content="字数：0" Margin="0,0,5,0" Padding="5" ScrollViewer.VerticalScrollBarVisibility="Disabled" VerticalContentAlignment="Center" MaxWidth="100" Height="30" VerticalAlignment="Center" HorizontalAlignment="Center" DockPanel.Dock="Right" Background="{x:Null}"/>
                    <Label x:Name="RowAndColumn" Content="行：0，列：0" Margin="0,0,5,0" VerticalAlignment="Center" Padding="5" Height="30" VerticalContentAlignment="Center" MaxWidth="150" HorizontalAlignment="Center" DockPanel.Dock="Right" Background="{x:Null}"/>
                    <Label x:Name="HelpMessage" Content="帮助消息" Margin="0" Height="30" VerticalContentAlignment="Center" Background="{x:Null}"/>
                </DockPanel>
                <TextBox x:Name="FileContent" VerticalScrollBarVisibility="Auto" AcceptsReturn="true" TextWrapping="Wrap"  TextChanged="FileContent_TextChanged" KeyUp="FileContent_KeyUp" 
                 SelectionChanged="FileContent_SelectionChanged" SizeChanged="FileContent_SizeChanged" LostFocus="FileContent_LostFocus" PreviewTextInput="FileContent_PreviewTextInput" BorderBrush="{x:Null}" CaretBrush="Black" Padding="5" Background="White" />
                <!--<Frame Margin="197,289,119,109" Source="AboutPage.xaml" Template="{StaticResource FrameTemplate}"></Frame>-->
            </DockPanel>
        </DockPanel>
    </Grid>
</Window>
